version: 2

models:
  - name: gld_customer_metrics
    description: "Gold layer comprehensive customer analytics and business metrics for customer performance analysis and segmentation"
    columns:
      - name: customer_id
        description: "Primary key for customer records"
        tests:
          - unique
          - not_null
      - name: customer_value_segment
        description: "Customer value segmentation based on revenue and frequency"
        tests:
          - accepted_values:
              values: ['VIP', 'HIGH_VALUE', 'MEDIUM_VALUE', 'LOW_VALUE', 'ONE_TIME_BUYER']
      - name: lifecycle_stage
        description: "Customer lifecycle stage classification"
        tests:
          - accepted_values:
              values: ['PROSPECT', 'LAPSED', 'ACTIVE', 'AT_RISK', 'CHURNED']
      - name: lifetime_revenue
        description: "Total revenue generated by customer"
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
      - name: total_orders
        description: "Total number of orders placed by customer"
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
      - name: avg_order_value
        description: "Average order value for customer"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
      - name: recency_score
        description: "RFM recency score (1-5 scale)"
        tests:
          - accepted_values:
              values: [1, 2, 3, 4, 5]
      - name: frequency_score
        description: "RFM frequency score (1-5 scale)"
        tests:
          - accepted_values:
              values: [1, 2, 3, 4, 5]
      - name: monetary_score
        description: "RFM monetary score (1-5 scale)"
        tests:
          - accepted_values:
              values: [1, 2, 3, 4, 5]
      - name: channel_preference
        description: "Customer channel preference classification"
        tests:
          - accepted_values:
              values: ['ONLINE_ONLY', 'OFFLINE_ONLY', 'OMNICHANNEL', 'NO_ORDERS']

  - name: gld_product_performance
    description: "Gold layer comprehensive product performance analytics for product analysis, inventory optimization, and profitability insights"
    columns:
      - name: product_id
        description: "Primary key for product records"
        tests:
          - unique
          - not_null
      - name: performance_category
        description: "Product performance classification"
        tests:
          - accepted_values:
              values: ['STAR_PRODUCT', 'HIGH_PERFORMER', 'SOLID_PERFORMER', 'LOW_PERFORMER', 'NO_SALES']
      - name: sales_lifecycle_stage
        description: "Product sales lifecycle stage"
        tests:
          - accepted_values:
              values: ['NO_SALES', 'ACTIVE_SELLER', 'SLOW_MOVING', 'DECLINING', 'DEAD_INVENTORY']
      - name: profitability_tier
        description: "Product profitability classification"
        tests:
          - accepted_values:
              values: ['HIGH_MARGIN', 'GOOD_MARGIN', 'ADEQUATE_MARGIN', 'LOW_MARGIN', 'LOSS_MAKING']
      - name: total_revenue
        description: "Total revenue generated by product"
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
      - name: total_quantity_sold
        description: "Total quantity sold of product"
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
      - name: actual_profit_margin_percentage
        description: "Actual profit margin percentage based on sales data"
        tests:
          - not_null
      - name: revenue_rank
        description: "Revenue ranking among all products"
        tests:
          - not_null
      - name: market_appeal
        description: "Product market appeal classification"
        tests:
          - accepted_values:
              values: ['BROAD_APPEAL', 'MODERATE_APPEAL', 'NICHE_APPEAL', 'LIMITED_APPEAL', 'NO_APPEAL']

  - name: gld_sales_summary
    description: "Gold layer comprehensive sales analytics and business intelligence dashboard for sales performance analysis and forecasting"
    columns:
      - name: sale_date
        description: "Date of sales transactions"
        tests:
          - unique
          - not_null
          - date_not_in_future
      - name: total_revenue
        description: "Total revenue for the day"
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
      - name: total_orders
        description: "Total number of orders for the day"
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
      - name: unique_customers
        description: "Number of unique customers who ordered"
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
      - name: sales_volume_category
        description: "Daily sales volume classification"
        tests:
          - accepted_values:
              values: ['HIGH_VOLUME_DAY', 'GOOD_VOLUME_DAY', 'NORMAL_VOLUME_DAY', 'LOW_VOLUME_DAY', 'NO_SALES_DAY']
      - name: day_type
        description: "Day type classification"
        tests:
          - accepted_values:
              values: ['WEEKEND', 'WEEKDAY']
      - name: order_season
        description: "Seasonal classification"
        tests:
          - accepted_values:
              values: ['WINTER', 'SPRING', 'SUMMER', 'FALL']
      - name: average_order_value
        description: "Average order value for the day"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
      - name: online_revenue_percentage
        description: "Percentage of revenue from online orders"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100
      - name: on_time_delivery_percentage
        description: "Percentage of on-time deliveries"
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100
